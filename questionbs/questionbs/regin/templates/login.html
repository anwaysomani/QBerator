{% extends "base.html" %}

{% block content %}
    <form class='my-ajax-form' method='POST' action='.' data-url='{{ request.build_absolute_uri|safe }}'>
	{% csrf_token %}

	<!-- Trial for old-new compare 
	{% for field in form %}
	  <p>
	      {% for error in field.errors %}
	        <p style="color:red">{{ error }}</p>
	      {% endfor %}
	      {% if field.help_text %}
	        <p><small style="color: grey">{{ field.help_text }}</small></p>
	     {% endif %}
	  </p>
	{% endfor %}
	{{form.as_p|safe}}-->
	<button type='submit' class="button">Login</button><br><br>
	<a href="{% url 'signup' %}">New Faculty Registration</a>
    </form>

<script>
$(document).ready(function(){
    var $myForm = $('.my-ajax-form')
    $myForm.submit(function(event){
        event.preventDefault()
        var $formData = $(this).serialize()
        var $thisURL = $myForm.attr('data-url') || window.location.href // or set your own url
        $.ajax({
            method: "POST",
            url: $thisURL,
            data: $formData,
            success: handleFormSuccess,
            error: handleFormError,
        })
    })

    function handleFormSuccess(data, textStatus, jqXHR){
        console.log(data)
        console.log(textStatus)
        console.log(jqXHR)
        $myForm.reset(); // reset form data
    }

    function handleFormError(jqXHR, textStatus, errorThrown){
        console.log(jqXHR)
        console.log(textStatus)
        console.log(errorThrown)
    }
})
</script>
{% endblock content %}
